# 表格导出预览功能使用指南

## 功能概述

表格导出预览功能为用户提供了在实际导出之前查看表格结构和内容的能力。通过详细的预览界面，用户可以：

- 查看表格的列结构和数据类型
- 预览样本数据内容
- 查看导出统计信息
- 验证导出配置是否正确

## 功能特性

### 1. 表格结构预览
- **列名显示**：显示所有将要导出的列名
- **数据类型**：自动识别每列的数据类型（文本、日期时间、数值、URL等）
- **列描述**：提供每列的详细说明，帮助用户理解数据含义

### 2. 样本数据预览
- **实际数据展示**：显示前5条文章的实际数据内容
- **内容截断**：长文本自动截断显示，避免界面过于拥挤
- **格式化显示**：使用等宽字体确保数据对齐

### 3. 统计信息
- **基本统计**：显示总文章数、样本数、列数等基本信息
- **来源分布**：按订阅源统计文章分布情况
- **格式信息**：显示选择的导出格式及其特性
- **配置状态**：显示翻译功能等配置状态

## 使用方法

### 1. 在主界面中使用

1. **选择文章**：在主界面中选择要导出的文章
2. **打开导出对话框**：点击"工具" → "表格导出"菜单
3. **配置导出选项**：
   - 选择导出格式（Excel、CSV、HTML、JSON）
   - 设置输出路径
   - 配置翻译选项
4. **点击预览**：点击"预览"按钮打开详细预览窗口

### 2. 在批量筛选结果中使用

1. **执行批量筛选**：使用批量筛选功能获取筛选结果
2. **查看结果**：在筛选结果对话框中查看筛选出的文章
3. **导出表格**：点击"导出表格"按钮
4. **预览内容**：在导出对话框中点击"预览"按钮

## 预览界面说明

### 导出信息区域
显示基本的导出配置信息：
- 文章数量
- 导出格式
- 翻译功能状态
- 来源分布统计

### 表格结构标签页
以表格形式显示：
- **列名**：将要导出的所有列名
- **数据类型**：每列的数据类型
- **描述**：每列的详细说明

常见的列包括：
- `标题`：文章标题
- `中文标题`：翻译后的中文标题（启用翻译时）
- `摘要`：文章摘要
- `中文摘要`：翻译后的中文摘要（启用翻译时）
- `内容`：文章正文内容
- `链接`：文章原始链接
- `发布时间`：文章发布时间
- `来源`：文章来源/订阅源
- `作者`：文章作者
- `筛选原因`：AI筛选的原因说明（AI筛选时）
- `筛选分数`：AI筛选的评分（AI筛选时）

### 样本数据标签页
显示前5条文章的实际数据内容：
- 每条记录以"=== 样本 N ==="分隔
- 显示每个字段的实际值
- 长文本自动截断为100字符
- 空值显示为"(空)"

### 统计信息标签页
提供详细的统计信息：

#### 导出统计信息
- 总文章数量
- 样本数量
- 列数量

#### 列信息
- 按顺序列出所有列名
- 便于用户确认导出内容

#### 来源统计
- 按订阅源统计文章数量
- 显示每个来源的文章数和百分比
- 按文章数量降序排列

#### 导出格式信息
- 显示选择的导出格式
- 说明该格式的特性和优势

## 支持的导出格式

### Excel格式 (.xlsx)
- **特性**：支持多工作表、格式化、图表等
- **优势**：功能丰富，适合数据分析
- **适用场景**：需要进一步处理和分析数据

### CSV格式 (.csv)
- **特性**：纯文本格式、易于导入其他工具
- **优势**：通用性强，文件小
- **适用场景**：数据交换、导入数据库

### HTML格式 (.html)
- **特性**：网页格式、支持样式和链接
- **优势**：可直接在浏览器中查看
- **适用场景**：生成报告、网页展示

### JSON格式 (.json)
- **特性**：结构化数据、易于程序处理
- **优势**：适合API接口、程序处理
- **适用场景**：数据交换、程序集成

## 翻译功能说明

当启用翻译功能时，预览将显示额外的翻译列：

- **中文标题**：外文标题的中文翻译
- **中文摘要**：外文摘要的中文翻译或摘要增强

翻译功能特点：
- 自动检测文章语言
- 智能摘要生成和增强
- 支持多种AI翻译服务
- 提供降级机制确保稳定性

## 注意事项

1. **预览数据限制**：预览只显示前5条文章的数据，实际导出会包含所有选中的文章

2. **翻译功能影响**：启用翻译功能会增加预览加载时间和导出时间

3. **网络连接**：翻译功能需要网络连接，请确保网络畅通

4. **API配置**：如果翻译功能出现错误，请检查AI服务的API配置

5. **内存使用**：大量文章的预览可能消耗较多内存，建议分批处理

## 故障排除

### 预览加载失败
- 检查文章数据是否有效
- 确认网络连接正常
- 查看错误日志获取详细信息

### 翻译功能异常
- 检查AI服务API配置
- 确认API密钥有效
- 查看API使用额度

### 界面显示问题
- 尝试刷新预览
- 重新打开预览窗口
- 检查系统字体设置

## 技术实现

预览功能的技术架构：

1. **数据处理**：使用表格导出服务的`preview_table_structure`方法
2. **UI组件**：基于Tkinter的多标签页界面
3. **异步加载**：后台线程加载数据，避免界面卡顿
4. **错误处理**：完善的异常处理和用户提示

## 更新日志

### v1.0.0
- 初始版本发布
- 支持基本的表格结构预览
- 提供样本数据展示
- 包含详细的统计信息
- 支持多种导出格式
- 集成翻译功能预览